# Настройка проброса портов на роутере

## Общая информация

**Публичный IP адрес:** 188.242.12.214
**Локальный IP сервера:** 192.168.0.246
**Порт Minecraft сервера:** 25570

## Что такое проброс портов (Port Forwarding)?

Проброс портов позволяет перенаправить входящие подключения из интернета на конкретное устройство в локальной сети. Без этого игроки из интернета не смогут подключиться к вашему серверу.

## Пошаговая инструкция

### Шаг 1: Войти в панель управления роутером

1. Откройте браузер
2. Введите IP адрес роутера (обычно один из следующих):
   - `192.168.0.1`
   - `192.168.1.1`
   - `192.168.100.1`
3. Введите логин и пароль (обычно admin/admin, если не меняли)

### Шаг 2: Найти раздел Port Forwarding

Раздел может называться по-разному в зависимости от модели роутера:
- Port Forwarding
- Virtual Server
- NAT
- Переадресация портов
- Виртуальный сервер

### Шаг 3: Создать правило проброса

Создайте новое правило со следующими параметрами:

| Параметр | Значение |
|----------|----------|
| **Имя/Service Name** | Minecraft Server |
| **Протокол/Protocol** | TCP и UDP (или Both) |
| **Внешний порт/External Port** | 25570 |
| **Внутренний порт/Internal Port** | 25570 |
| **IP адрес/Internal IP** | 192.168.0.246 |
| **Статус/Status** | Enabled/Включено |

### Шаг 4: Сохранить и применить настройки

1. Нажмите "Применить" или "Save"
2. Роутер может перезагрузиться (подождите 1-2 минуты)

### Шаг 5: Проверить доступность

После настройки проброса портов проверьте доступность сервера:

#### Вариант 1: Через онлайн-сервис
1. Откройте: https://www.yougetsignal.com/tools/open-ports/
2. Введите:
   - IP адрес: `188.242.12.214`
   - Port: `25570`
3. Нажмите "Check"
4. Должно показать "Open" (открыт)

**Примечание:** Проверка будет работать только если сервер запущен!

#### Вариант 2: Через командную строку
```bash
telnet 188.242.12.214 25570
```

Если подключение успешно - порт открыт.

### Шаг 6: Подключение к серверу

После настройки игроки смогут подключиться к серверу по адресу:
```
188.242.12.214:25570
```

## Возможные проблемы

### Проблема 1: Порт закрыт после настройки

**Причины:**
- Сервер не запущен
- Файрвол Windows блокирует подключения
- Провайдер блокирует входящие подключения

**Решение:**
1. Убедитесь что сервер запущен: `docker-compose ps`
2. Отключите Windows Firewall временно для теста
3. Обратитесь к провайдеру если блокирует

### Проблема 2: Не могу зайти в настройки роутера

**Решение:**
1. Проверьте шлюз по умолчанию:
   ```cmd
   ipconfig
   ```
   Ищите строку "Основной шлюз" / "Default Gateway"
2. Используйте найденный IP адрес для входа

### Проблема 3: Динамический локальный IP

Если локальный IP сервера меняется при перезагрузке:

**Решение:** Настройте статический IP:
1. Панель управления → Сеть → Ethernet → Свойства
2. IPv4 → Свойства
3. Использовать следующий IP-адрес:
   - IP: 192.168.0.246
   - Маска: 255.255.255.0
   - Шлюз: 192.168.0.1
   - DNS: 8.8.8.8, 8.8.4.4

## Примеры для популярных роутеров

### TP-Link
1. Advanced → NAT Forwarding → Virtual Servers
2. Add → заполните данные → Save

### ASUS
1. WAN → Virtual Server / Port Forwarding
2. Enable Port Forwarding: Yes
3. Add profile → заполните данные → Apply

### D-Link
1. Advanced → Port Forwarding
2. Add → заполните данные → Save Settings

### ZyXEL Keenetic
1. Интернет-фильтры → Переадресация
2. Добавить правило → заполните данные → Сохранить

## Проверка после настройки

1. Запустите сервер:
   ```bash
   docker-compose up -d
   ```

2. Проверьте что все контейнеры запущены:
   ```bash
   docker-compose ps
   ```

3. Проверьте логи Velocity:
   ```bash
   docker-compose logs velocity
   ```
   Должна быть строка: `Listening on /0.0.0.0:25570`

4. Попробуйте подключиться из Minecraft клиента:
   - Адрес: `188.242.12.214:25570`

## Дополнительные рекомендации

1. **Резервирование IP адреса:** В настройках роутера можно привязать MAC-адрес сервера к IP 192.168.0.246, чтобы он не менялся

2. **UPnP:** Некоторые роутеры поддерживают UPnP для автоматического проброса портов, но лучше настроить вручную для надежности

3. **Безопасность:** Используйте сложные пароли для администраторов сервера

4. **Мониторинг:** Установите систему мониторинга для отслеживания работы сервера

## Альтернативные решения

Если проброс портов не работает или провайдер блокирует:

1. **VPN сервис:** Используйте VPN с пробросом портов (например, ZeroTier)
2. **Облачный хостинг:** Перенесите сервер на VPS
3. **Туннелирование:** Используйте ngrok или playit.gg (для тестирования)

## Контакты провайдера

Если ничего не помогает, обратитесь к провайдеру:
- Убедитесь что у вас **белый IP адрес** (не серый, не общий CGNAT)
- Попросите разблокировать входящие подключения на порт 25570
- Уточните нет ли ограничений на хостинг игровых серверов
